<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no" charset="utf-8">
  <title>Honeycrisp Design System</title>
  <%= csrf_meta_tags %>
  <%= csp_meta_tag %>

  <%= stylesheet_link_tag    'application', media: 'all' %>
  <%= stylesheet_link_tag    'prism', media: 'all' %>

  <%= javascript_include_tag 'application' %>
  <%= javascript_include_tag 'prism' %>
</head>

<body class="template--<%= content_for(:template_name) if content_for?(:template_name) %>">
  <div class="page-wrapper">
    <header class="main-header">
      <div class="toolbar">
        <div class="toolbar__left">
          <h1 class="main-header__title"><a class="main-header__logo" href="#">Honeycrisp Design System v<%= Cfa::Styleguide::VERSION %></a></h1>
        </div>
        <div class="toolbar__right">
          <%= link_to "Atoms", styleguide_main_path(anchor: "atoms"), class: %w{toolbar__item text--small link--subtle} %>
          <%= link_to "Molecules", styleguide_main_path(anchor: "molecules"), class: %w{toolbar__item text--small link--subtle} %>
          <%= link_to "Organisms", styleguide_main_path(anchor: "organisms"), class: %w{toolbar__item text--small link--subtle} %>
          <%= link_to "Form Builder", styleguide_form_builder_path, class: %w{toolbar__item text--small link--subtle} %>
          <%= link_to "Emojis", styleguide_emojis_path, class: %w{toolbar__item text--small link--subtle} %>
        </div>
      </div>
    </header>
    <%= yield %>
  </div>

  <footer class="main-footer">
    <div class="grid">
      <div class="grid__item">
        <div class="main-footer__legal">
          <p>The CfA Styleguide is a pattern library developed by <a class="link--subtle" href="#">Code for America</a>.</p>
        </div>
      </div>
    </div>
  </footer>

  <script>
      var pattern = (function() {

          /**
           <div class="pattern__example"></div>
           <div class="pattern">
             <div class="pattern__html"></div> CODE BELOW ATTACHES THIS
             <div class="pattern__code"></div>
           </div>
           **/

          var p = {
              render: function(exampleRubyCode, exampleHtml) {
                  var sampleCodeBox = $('<div class="pattern__html"><a href="#" class="pattern__button"><i class="icon-arrow_drop_down"></i></a><pre><code class="language-markup"></code></pre></div>');
                  $(sampleCodeBox).find('code').text($(exampleHtml).html());
                  $(exampleRubyCode).before(sampleCodeBox);
              },

              init: function() {
                  $('.pattern').each(function(index, pattern) {
                      var exampleRubyCode = $(this).find('.pattern__code');
                      var exampleHtml = $(this).find('.pattern__example');
                      p.render(exampleRubyCode, exampleHtml);

                      $(this).find('.pattern__button').click(function(e) {
                          e.preventDefault();
                          $(this).parent().toggleClass('is-open');
                      })

                  });
              }
          };

          return {
              init: p.init
          }
      })();

      pattern.init();
  </script>
</body>
</html>
